(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[725],{4122:function(e,t,s){Promise.resolve().then(s.bind(s,8201))},8201:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var n=s(1443),a=s(7954),i=s(3038),l=s(9277),d=s(2002),r=s(437),o=s(3355),c=s(5395),u=s(3490),p=s(7088),x=s(6613);function m(){var e,t;let{id:s}=(0,i.useParams)(),{user:m}=(0,r.t)(),[h,g]=(0,a.useState)(null),[f,v]=(0,a.useState)(!1),[b,y]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{let e=(0,l.JU)(d.db,"polls",s),t=await (0,l.QT)(e);if(t.exists()){var n;let e;let s=t.data(),a=s.deadline;if("string"==typeof a){let t=new Date(a);isNaN(t.getTime())||(e=t.toISOString().slice(0,10))}else if("object"==typeof a&&null!==a&&"toDate"in a&&"function"==typeof a.toDate){let t=a.toDate();isNaN(t.getTime())||(e=t.toISOString().slice(0,10))}s.deadline=e,g(s),m&&(null===(n=s.votedUsers)||void 0===n?void 0:n.includes(m.uid))&&v(!0)}})()},[s,m]);let j=async()=>{if(!h||!m||!b)return;let e=(0,l.JU)(d.db,"polls",s),t=h.options.map(e=>e.id===b?{...e,votes:e.votes?[...e.votes,m.uid]:[m.uid]}:e);await (0,l.r7)(e,{options:t,votedUsers:(0,l.vr)(m.uid)}),g({...h,options:t,votedUsers:[...h.votedUsers||[],m.uid]}),v(!0)};if(!h)return(0,n.jsx)("p",{className:"p-4",children:"투표 정보를 불러오는 중..."});let N=h.options.reduce((e,t)=>{var s;return e+((null===(s=t.votes)||void 0===s?void 0:s.length)||0)},0),D=(null===(e=h.createdAt)||void 0===e?void 0:e.toDate)?(0,u.WU)(h.createdAt.toDate(),"yyyy. M. d.",{locale:x.ko}):"날짜 없음",w=h.deadline?"".concat((0,u.WU)(new Date(h.deadline),"yyyy. M. d.",{locale:x.ko})," (D-").concat(Math.max(0,(0,p.w)(new Date(h.deadline),new Date)),")"):"마감일 없음";return(0,n.jsxs)("div",{className:"max-w-2xl mx-auto px-4 py-8",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-4",children:h.title}),(0,n.jsxs)("div",{className:"text-sm text-gray-700 space-y-1 mb-6",children:[(0,n.jsxs)("p",{children:["\uD83D\uDCC2 ",(0,n.jsx)("b",{children:"카테고리:"})," ",h.category]}),(0,n.jsxs)("p",{children:["\uD83D\uDEE0️ ",(0,n.jsx)("b",{children:"제작일:"})," ",D]}),(0,n.jsxs)("p",{children:["⏰ ",(0,n.jsx)("b",{children:"마감일:"})," ",w]}),(0,n.jsxs)("p",{children:["\uD83D\uDC65 ",(0,n.jsx)("b",{children:"참여제한:"})," ",null!==(t=h.maxParticipants)&&void 0!==t?t:"제한 없음","명"]})]}),(0,n.jsx)("div",{className:"space-y-4",children:h.options.map(e=>{var t;let s=(null===(t=e.votes)||void 0===t?void 0:t.length)||0,a=N>0?s/N*100:0;return(0,n.jsxs)("div",{className:"p-4 rounded-lg bg-gray-100 cursor-pointer ".concat(b===e.id?"ring-2 ring-blue-500":""),style:{opacity:f?1:.8},onClick:()=>!f&&y(e.id),children:[(0,n.jsx)("p",{className:"mb-1",children:e.text}),f?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:[s,"표 \xb7 ",a.toFixed(1),"%"]}),(0,n.jsx)("div",{className:"w-full bg-gray-300 h-2 rounded",children:(0,n.jsx)("div",{className:"bg-blue-500 h-2 rounded",style:{width:"".concat(a,"%")}})})]}):e.imageUrl&&(0,n.jsx)(o.default,{src:e.imageUrl,alt:"Option image",width:120,height:120,className:"mt-2 rounded"})]},e.id)})}),!f&&(0,n.jsx)("button",{onClick:j,disabled:!b,className:"mt-6 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-40",children:"투표하기"}),f&&(0,n.jsxs)("div",{className:"mt-6",children:[(0,n.jsx)("p",{className:"text-green-600 font-semibold",children:"투표해 주셔서 감사합니다!"}),(0,n.jsxs)("div",{className:"mt-4 flex flex-wrap gap-3",children:[(0,n.jsx)(c.default,{href:"/create",className:"inline-flex items-center gap-1 px-4 py-2 bg-blue-100 text-blue-800 rounded-full hover:bg-blue-200 transition",children:"✏️ 새 투표 만들기"}),(0,n.jsx)(c.default,{href:"/mypage",className:"inline-flex items-center gap-1 px-4 py-2 bg-gray-100 text-gray-800 rounded-full hover:bg-gray-200 transition",children:"\uD83D\uDCCB 마이페이지로 이동"}),(0,n.jsx)(c.default,{href:"/",className:"inline-flex items-center gap-1 px-4 py-2 bg-green-100 text-green-800 rounded-full hover:bg-green-200 transition",children:"\uD83C\uDFE0 메인으로 가기"})]})]})]})}},2002:function(e,t,s){"use strict";s.d(t,{I:function(){return r},db:function(){return o}});var n=s(4991),a=s(7568),i=s(9277),l=s(3521);let d=(0,n.ZF)({apiKey:"AIzaSyAws91QdnLflrzzHG9Nqh6kuc-cF5fJF9w",authDomain:"myvote-d6e8a.firebaseapp.com",projectId:"myvote-d6e8a",storageBucket:"myvote-d6e8a.appspot.com",messagingSenderId:"419357195756",appId:"1:419357195756:web:861b197a9d92d06dc914c9"}),r=(0,a.v0)(d),o=(0,i.ad)(d);(0,l.cF)(d)},437:function(e,t,s){"use strict";s.d(t,{t:function(){return n}});let n=(0,s(7957).U)(e=>({user:null,loading:!0,setUser:t=>e({user:t}),setLoading:t=>e({loading:t})}))}},function(e){e.O(0,[126,411,114,289,395,585,878,323,744],function(){return e(e.s=4122)}),_N_E=e.O()}]);